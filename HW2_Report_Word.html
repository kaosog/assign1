<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>HW2 Report: Gender Classification from Face Images Using KNN</title>
  <style>
    body { font-family: "Times New Roman", Times, serif; font-size: 12pt; line-height: 1.4; margin: 1in; }
    h1, h2 { margin-bottom: 0.2em; }
    h1 { font-size: 16pt; }
    h2 { font-size: 13pt; margin-top: 1.0em; }
    p { margin: 0.35em 0; }
    ul, ol { margin: 0.25em 0 0.25em 1.2em; }
    .mono { font-family: "Courier New", monospace; }
    .matrix { white-space: pre; font-family: "Courier New", monospace; }
  </style>
</head>
<body>
  <h1>HW2 Report: Gender Classification from Face Images Using KNN</h1>

  <h2>Introduction</h2>
  <p>This project applies a K-Nearest Neighbors (KNN) classifier to predict gender from face landmark features. The workflow includes feature extraction from landmark points, model training/testing with Scikit-learn, and evaluation using confusion matrix, accuracy, precision, and recall.</p>

  <h2>Problem Description</h2>
  <p>The goal is to classify each face image as either <b>male</b> or <b>female</b> using geometric facial features computed from 22 landmark points. KNN is used as the supervised classifier, and performance is measured on a held-out test set.</p>

  <h2>Data Sets and Experiment Design</h2>
  <p>The data comes from the AR face database subset used in class:</p>
  <ul>
    <li>10 people total: 5 male (m-001 to m-005) and 5 female (w-001 to w-005)</li>
    <li>4 images per person</li>
    <li>Total samples: 40 images</li>
  </ul>
  <p>Each image has a <span class="mono">.pts</span> file containing 22 <span class="mono">(x, y)</span> coordinates.</p>

  <p><b>Train/Test Split (person-level split):</b></p>
  <ul>
    <li>Training people: m-001, m-002, m-003, w-001, w-002, w-003 (24 images)</li>
    <li>Testing people: m-004, m-005, w-004, w-005 (16 images)</li>
  </ul>

  <h2>Defining Features and Feature Extraction</h2>
  <p>Seven ratio-based features were extracted from landmark points using Euclidean distance:</p>
  <ol>
    <li>Eye length ratio: max(d(9,10), d(11,12)) / d(8,13)</li>
    <li>Eye distance ratio: d(0,1) / d(8,13)</li>
    <li>Nose ratio: d(15,16) / d(20,21)</li>
    <li>Lip size ratio: d(2,3) / d(17,18)</li>
    <li>Lip length ratio: d(2,3) / d(20,21)</li>
    <li>Eyebrow length ratio: max(d(4,5), d(6,7)) / d(8,13)</li>
    <li>Aggressive ratio: d(10,19) / d(20,21)</li>
  </ol>
  <p>Feature extraction script: <span class="mono">assign1/hw1_feature_extract.py</span><br>
     Output CSV: <span class="mono">assign1/outputs/features.csv</span></p>

  <h2>Results and Analysis</h2>
  <p>KNN was implemented with standardization (StandardScaler + KNeighborsClassifier).</p>

  <p><b>K Selection:</b> Tested k = [1, 3, 5, 7, 9] and selected the best based on accuracy (then precision/recall tie-breakers). Best result occurred at <b>k = 9</b>.</p>

  <p><b>Final Test Results (k = 9)</b></p>
  <p>Confusion matrix (rows = true, columns = predicted, labels = [male, female]):</p>
  <p class="matrix">[[7, 1],
 [5, 3]]</p>

  <p>Metrics (male as positive class):</p>
  <ul>
    <li>Accuracy: <b>0.6250</b></li>
    <li>Precision: <b>0.5833</b></li>
    <li>Recall: <b>0.8750</b></li>
  </ul>

  <p><b>Discussion:</b></p>
  <ul>
    <li>The model performs better than chance but remains limited (62.5% accuracy).</li>
    <li>Recall for male is high, meaning most male samples are detected.</li>
    <li>Female samples are more often misclassified (5 of 8 female test images predicted as male).</li>
    <li>Likely causes: very small training set and overlap of handcrafted geometric features between classes.</li>
  </ul>

  <h2>Conclusion</h2>
  <p>This assignment successfully implemented gender classification from face landmark features using KNN. All required deliverables were produced: feature extraction, classification pipeline, confusion matrix, and core evaluation metrics. The current setup shows moderate performance; larger training data or additional features would likely improve results.</p>

  <h2>References</h2>
  <ol>
    <li>AR Face Database (course-provided subset)</li>
    <li>Scikit-learn documentation: KNeighborsClassifier<br>
      https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html</li>
    <li>Scikit-learn metrics documentation<br>
      https://scikit-learn.org/stable/modules/model_evaluation.html</li>
  </ol>
</body>
</html>
